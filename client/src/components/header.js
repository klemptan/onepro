import React, { useContext, useEffect, useState } from 'react';
import { useNavigate } from "react-router-dom";
import { Context } from "../index";
import { observer } from 'mobx-react-lite'
const Header = observer(() => {

    const [searchActive, setSearchActive] = useState(false);
    const [searchQuery, setSearchQuery] = useState('');
    const { basket } = useContext(Context)
    const navigate = useNavigate();

    const goToSearch = () => {
        if (!searchActive) {
            setSearchActive(true)
        }
        else {
            navigate("/search/"+searchQuery)   
        }
    }



    return (
        <header>
            <a href="/" className="logo">
                OnePro
            </a>
            <div className="middle">
                <ul>
                    <li>
                        <span>Горячая линия</span>
                        <a href="/">8 800-250-95-61</a>
                    </li>
                    <li>
                        <span>Отдел продаж</span>
                        <a href="/">+7 (918) 558-10-07</a>
                    </li>
                    <li>
                        <span>Задать вопрос</span>
                        <a href="/">sale@onepro.kz</a>
                    </li>
                </ul>
                <a href="/favorites" className="saved">
                    <span>Избранное</span>
                    <div className="icon-star">
                        {basket.favorites.length == 0 ?


                            <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><rect fill="none" height="402" width="582" y="-1" x="-1" /><path fill="#186ddf" d="m16.855,20.966c-0.224,0 -0.443,-0.05 -0.646,-0.146c-0.035,-0.014 -0.069,-0.031 -0.104,-0.051l-4.107,-2.343l-4.107,2.344c-0.035,0.02 -0.07,0.037 -0.106,0.053c-0.488,0.228 -1.085,0.174 -1.521,-0.143c-0.469,-0.34 -0.701,-0.933 -0.586,-1.509l0.957,-4.642c-0.374,-0.34 -0.962,-0.875 -1.602,-1.457l-1.895,-1.725c-0.027,-0.025 -0.055,-0.053 -0.078,-0.082c-0.375,-0.396 -0.509,-0.97 -0.34,-1.492c0.173,-0.524 0.62,-0.912 1.16,-1.009c0.034,-0.008 0.067,-0.014 0.102,-0.018l4.701,-0.521l1.946,-4.31c0.017,-0.038 0.036,-0.075 0.06,-0.11c0.262,-0.473 0.764,-0.771 1.309,-0.771c0.543,0 1.044,0.298 1.309,0.77c0.021,0.036 0.041,0.073 0.06,0.112l1.948,4.312l4.701,0.521c0.034,0.003 0.068,0.009 0.104,0.017c0.539,0.1 0.986,0.486 1.158,1.012c0.17,0.521 0.035,1.098 -0.34,1.494c-0.024,0.026 -0.051,0.054 -0.078,0.078l-3.498,3.184l0.957,4.632c0.113,0.587 -0.118,1.178 -0.59,1.519c-0.252,0.182 -0.556,0.281 -0.874,0.281zm-8.149,-6.564c-0.039,0.182 -0.466,2.246 -0.845,4.082l3.643,-2.077c0.307,-0.175 0.684,-0.175 0.99,0l3.643,2.075l-0.849,-4.104c-0.071,-0.346 0.045,-0.705 0.308,-0.942l3.1,-2.822l-4.168,-0.461c-0.351,-0.039 -0.654,-0.26 -0.801,-0.584l-1.728,-3.821l-1.726,3.821c-0.146,0.322 -0.45,0.543 -0.801,0.584l-4.168,0.461l3.1,2.822c0.272,0.246 0.384,0.617 0.302,0.966z" /></svg>
                            :
                            <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
                                <rect fill="none" id="canvas_background" height="402" width="582" y="-1" x="-1"></rect>
                                <path fill="#186ddf" id="svg_3"
                                    d="m9.362,9.158c0,0 -3.16,0.35 -5.268,0.584c-0.19,0.023 -0.358,0.15 -0.421,0.343s0,0.394 0.14,0.521c1.566,1.429 3.919,3.569 3.919,3.569c-0.002,0 -0.646,3.113 -1.074,5.19c-0.036,0.188 0.032,0.387 0.196,0.506c0.163,0.119 0.373,0.121 0.538,0.028c1.844,-1.048 4.606,-2.624 4.606,-2.624s2.763,1.576 4.604,2.625c0.168,0.092 0.378,0.09 0.541,-0.029c0.164,-0.119 0.232,-0.318 0.195,-0.505c-0.428,-2.078 -1.071,-5.191 -1.071,-5.191s2.353,-2.14 3.919,-3.566c0.14,-0.131 0.202,-0.332 0.14,-0.524s-0.23,-0.319 -0.42,-0.341c-2.108,-0.236 -5.269,-0.586 -5.269,-0.586s-1.31,-2.898 -2.183,-4.83c-0.082,-0.173 -0.254,-0.294 -0.456,-0.294s-0.375,0.122 -0.453,0.294c-0.874,1.932 -2.183,4.83 -2.183,4.83z"></path>
                            </svg>
                        }
                    </div>
                    <span id="wishcount">{basket.favorites.length}</span>
                </a>
                <div className="social">
                    <a href="https://t.me/ISELF_RUSSIA" target="_blank">
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clipPath="url(#clip0_2508_46)">
                                <path
                                    d="M11 22C17.0751 22 22 17.0751 22 11C22 4.92487 17.0751 0 11 0C4.92487 0 0 4.92487 0 11C0 17.0751 4.92487 22 11 22Z"
                                    fill="#0088CC"></path>
                                <path
                                    d="M10.5905 14.279C10.062 14.7903 9.54204 15.2973 9.02212 15.8044C8.84165 15.9805 8.6397 16.0794 8.37759 16.0665C8.20142 16.0579 8.10259 15.9805 8.04673 15.813C7.65141 14.5841 7.24751 13.3552 6.8522 12.122C6.81352 12.0016 6.75766 11.9458 6.63735 11.9071C5.70493 11.6235 4.76821 11.3313 3.84009 11.0348C3.69829 10.9876 3.5522 10.9317 3.42759 10.8458C3.23423 10.7169 3.20845 10.5063 3.38032 10.3516C3.53931 10.2098 3.72837 10.0895 3.92602 10.0122C5.06899 9.56102 6.21626 9.12274 7.36352 8.68016C10.2725 7.55867 13.1815 6.43289 16.0905 5.31141C16.6448 5.09656 17.0702 5.39734 17.01 5.99891C16.9713 6.38133 16.8725 6.75945 16.7952 7.13758C16.1635 10.1196 15.5319 13.1059 14.8959 16.088C14.7456 16.797 14.2471 16.9817 13.667 16.552C12.6917 15.8345 11.7163 15.1126 10.7409 14.3907C10.6936 14.352 10.6463 14.3177 10.5905 14.279ZM8.39907 15.1856C8.41196 15.1813 8.42056 15.1813 8.43345 15.177C8.43774 15.147 8.44634 15.1212 8.45063 15.0954C8.51509 14.4208 8.57954 13.7419 8.6354 13.0673C8.64829 12.9169 8.69985 12.8095 8.81157 12.7063C9.70962 11.9028 10.6077 11.0907 11.5014 10.2829C12.494 9.38914 13.4866 8.49539 14.4749 7.59735C14.535 7.54149 14.5608 7.44695 14.6038 7.36961C14.5092 7.36102 14.4104 7.32234 14.3245 7.34383C14.2084 7.37391 14.101 7.44266 13.9979 7.50711C11.8108 8.88641 9.61938 10.2657 7.43227 11.645C7.30766 11.7223 7.28618 11.7868 7.33345 11.9243C7.49673 12.3884 7.64282 12.8567 7.79321 13.3251C7.99517 13.9438 8.19712 14.5669 8.39907 15.1856Z"
                                    fill="white"></path>
                            </g>
                            <defs>
                                <clipPath id="clip0_2508_46">
                                    <rect width="22" height="22" fill="white"></rect>
                                </clipPath>
                            </defs>
                        </svg>
                    </a>
                    <a href="https://wa.me/+79185581007?text=" target="_blank">
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fillRule="evenodd" clipRule="evenodd"
                                d="M11 22C17.0751 22 22 17.0751 22 11C22 4.92487 17.0751 0 11 0C4.92487 0 0 4.92487 0 11C0 17.0751 4.92487 22 11 22Z"
                                fill="#57BB63"></path>
                            <path fillRule="evenodd" clipRule="evenodd"
                                d="M11.0263 16.9479C9.97747 16.9479 8.99214 16.6799 8.13489 16.2094L4.82324 17.2618L5.9028 14.0772C5.35828 13.1828 5.0446 12.1338 5.0446 11.0125C5.0446 7.73448 7.72264 5.07715 11.0264 5.07715C14.3298 5.07715 17.0079 7.73448 17.0079 11.0125C17.0079 14.2906 14.33 16.9479 11.0263 16.9479ZM11.0263 6.0224C8.25308 6.0224 5.9973 8.26099 5.9973 11.0125C5.9973 12.1044 6.35322 13.1156 6.95514 13.9383L6.32696 15.7915L8.25944 15.1772C9.05361 15.6986 10.0048 16.0027 11.0263 16.0027C13.7991 16.0027 16.0553 13.7642 16.0553 11.0127C16.0553 8.26112 13.7991 6.0224 11.0263 6.0224ZM14.0467 12.3795C14.0099 12.319 13.9122 12.2825 13.7658 12.2098C13.619 12.137 12.898 11.7849 12.7638 11.7366C12.6292 11.6881 12.5314 11.6636 12.4338 11.8093C12.3361 11.955 12.0551 12.2825 11.9694 12.3795C11.8838 12.4767 11.7984 12.4889 11.6518 12.4161C11.5053 12.3434 11.0328 12.1897 10.4726 11.6941C10.0368 11.3085 9.74244 10.8325 9.65701 10.6867C9.57145 10.5411 9.64794 10.4625 9.72132 10.39C9.78726 10.3248 9.86794 10.2201 9.94132 10.1353C10.0147 10.0502 10.0391 9.98971 10.0878 9.89251C10.1368 9.79544 10.1123 9.71055 10.0756 9.63758C10.0389 9.56488 9.74556 8.84896 9.62344 8.55762C9.50132 8.26654 9.37934 8.31501 9.29364 8.31501C9.20808 8.31501 9.11033 8.30282 9.01258 8.30282C8.91484 8.30282 8.75589 8.33924 8.62146 8.48478C8.48716 8.63045 8.10849 8.98245 8.10849 9.69823C8.10849 10.4141 8.63364 11.1058 8.70716 11.2028C8.7804 11.2997 9.72119 12.8165 11.2116 13.3991C12.7026 13.9815 12.7026 13.7873 12.9715 13.763C13.24 13.7388 13.8386 13.4112 13.9612 13.0715C14.0831 12.7315 14.0831 12.4402 14.0467 12.3795Z"
                                fill="white"></path>
                        </svg>
                    </a>
                    <a href="https://www.instagram.com/iself.shop/" target="_blank">
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clipPath="url(#clip0_2508_66)">
                                <path
                                    d="M11 22C4.9258 22 0 17.0742 0 11C0 4.9258 4.9258 0 11 0C17.0742 0 22 4.9258 22 11C22 17.0742 17.0742 22 11 22Z"
                                    fill="url(#paint0_linear_2508_66)"></path>
                                <path
                                    d="M11.0001 4.84421C13.0043 4.84421 13.2419 4.85081 14.0339 4.88821C14.7665 4.92121 15.1647 5.04441 15.4287 5.14781C15.7785 5.28421 16.0293 5.44701 16.2911 5.70881C16.5529 5.97061 16.7157 6.22141 16.8521 6.57121C16.9555 6.83521 17.0765 7.23341 17.1117 7.96601C17.1469 8.75801 17.1557 8.99561 17.1557 10.9998C17.1557 13.004 17.1491 13.2416 17.1117 14.0336C17.0787 14.7662 16.9555 15.1644 16.8521 15.4284C16.7157 15.7782 16.5529 16.029 16.2911 16.2908C16.0293 16.5526 15.7785 16.7154 15.4287 16.8518C15.1647 16.9552 14.7665 17.0762 14.0339 17.1114C13.2419 17.1466 13.0043 17.1554 11.0001 17.1554C8.99586 17.1554 8.75826 17.1488 7.96626 17.1114C7.23366 17.0784 6.83546 16.9552 6.57146 16.8518C6.22166 16.7154 5.97086 16.5526 5.70906 16.2908C5.44726 16.029 5.28446 15.7782 5.14806 15.4284C5.04466 15.1644 4.92366 14.7662 4.88846 14.0336C4.85326 13.2416 4.84446 13.004 4.84446 10.9998C4.84446 8.99561 4.85106 8.75801 4.88846 7.96601C4.92146 7.23341 5.04466 6.83521 5.14806 6.57121C5.28446 6.22141 5.44726 5.97061 5.70906 5.70881C5.97086 5.44701 6.22166 5.28421 6.57146 5.14781C6.83546 5.04441 7.23366 4.92341 7.96626 4.88821C8.75826 4.85081 8.99586 4.84421 11.0001 4.84421ZM11.0001 3.49121C8.96066 3.49121 8.70546 3.50001 7.90466 3.53741C7.10606 3.57481 6.56046 3.70021 6.08086 3.88721C5.58806 4.07641 5.16786 4.33381 4.75206 4.75181C4.33406 5.16981 4.07886 5.58781 3.88526 6.08281C3.70046 6.56021 3.57286 7.10581 3.53546 7.90661C3.49806 8.70741 3.48926 8.96261 3.48926 11.002C3.48926 13.0414 3.49806 13.2966 3.53546 14.0974C3.57286 14.896 3.69826 15.4416 3.88526 15.9212C4.07666 16.4118 4.33406 16.832 4.75206 17.2478C5.17006 17.6658 5.58806 17.921 6.08306 18.1146C6.56046 18.2994 7.10606 18.427 7.90686 18.4644C8.70766 18.5018 8.96286 18.5106 11.0023 18.5106C13.0417 18.5106 13.2969 18.5018 14.0977 18.4644C14.8963 18.427 15.4419 18.3016 15.9215 18.1146C16.4121 17.9232 16.8323 17.6658 17.2481 17.2478C17.6661 16.8298 17.9213 16.4118 18.1149 15.9168C18.2997 15.4394 18.4273 14.8938 18.4647 14.093C18.5021 13.2922 18.5109 13.037 18.5109 10.9976C18.5109 8.95821 18.5021 8.70301 18.4647 7.90221C18.4273 7.10361 18.3019 6.55801 18.1149 6.07841C17.9235 5.58781 17.6661 5.16761 17.2481 4.75181C16.8301 4.33381 16.4121 4.07861 15.9171 3.88501C15.4397 3.70021 14.8941 3.57261 14.0933 3.53521C13.2947 3.50001 13.0395 3.49121 11.0001 3.49121Z"
                                    fill="white"></path>
                                <path
                                    d="M11.0002 7.14307C8.87055 7.14307 7.14355 8.87007 7.14355 10.9997C7.14355 13.1293 8.87055 14.8563 11.0002 14.8563C13.1298 14.8563 14.8568 13.1293 14.8568 10.9997C14.8568 8.87007 13.1298 7.14307 11.0002 7.14307ZM11.0002 13.5033C9.61855 13.5033 8.49655 12.3835 8.49655 10.9997C8.49655 9.61587 9.61855 8.49607 11.0002 8.49607C12.3818 8.49607 13.5038 9.61587 13.5038 10.9997C13.5038 12.3835 12.3818 13.5033 11.0002 13.5033Z"
                                    fill="white"></path>
                                <path
                                    d="M15.0084 7.89336C15.5066 7.89336 15.9104 7.48952 15.9104 6.99136C15.9104 6.49319 15.5066 6.08936 15.0084 6.08936C14.5103 6.08936 14.1064 6.49319 14.1064 6.99136C14.1064 7.48952 14.5103 7.89336 15.0084 7.89336Z"
                                    fill="white"></path>
                            </g>
                            <defs>
                                <linearGradient id="paint0_linear_2508_66" x1="3.22182" y1="18.7782" x2="18.7782"
                                    y2="3.22182" gradientUnits="userSpaceOnUse">
                                    <stop stopColor="#FFD521"></stop>
                                    <stop offset="0.0551048" stopColor="#FFD020"></stop>
                                    <stop offset="0.1241" stopColor="#FEC01E"></stop>
                                    <stop offset="0.2004" stopColor="#FCA71B"></stop>
                                    <stop offset="0.2821" stopColor="#FA8316"></stop>
                                    <stop offset="0.3681" stopColor="#F85510"></stop>
                                    <stop offset="0.4563" stopColor="#F51E09"></stop>
                                    <stop offset="0.5" stopColor="#F30005"></stop>
                                    <stop offset="0.5035" stopColor="#F20007"></stop>
                                    <stop offset="0.5966" stopColor="#E1003B"></stop>
                                    <stop offset="0.6879" stopColor="#D30067"></stop>
                                    <stop offset="0.7757" stopColor="#C70088"></stop>
                                    <stop offset="0.8589" stopColor="#BF00A0"></stop>
                                    <stop offset="0.9357" stopColor="#BB00AF"></stop>
                                    <stop offset="1" stopColor="#B900B4"></stop>
                                </linearGradient>
                                <clipPath id="clip0_2508_66">
                                    <rect width="22" height="22" fill="white"></rect>
                                </clipPath>
                            </defs>
                        </svg>

                    </a>
                </div>
                <div className={"search-dropdown " + (searchActive ? "active" : "")} itemScope="" itemType="https://schema.org/WebSite">


                    <div className="search-form" >
                        <input type="text" value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} name="q" className="search-info" id="search_info"
                            placeholder="ПОИСК ТОВАРА" maxLength="50" />
                        <div className="form-container">
                            <input type="button" onClick={() => goToSearch} className="search-submit" />
                        </div>
                    </div>
                    <div className="search-icon">
                        <span className={searchActive ? 'hidden' : ''}>Поиск товара</span>
                        {searchActive ?
                            <svg xmlns="http://www.w3.org/2000/svg" onClick={() => setSearchActive(false)} width="16" height="16" fill="currentColor" className="bi bi-x-lg me-3" viewBox="0 0 16 16">
                                <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                            </svg>
                            :
                            <></>}
                        <svg width="19" onClick={() => goToSearch()} height="17" viewBox="0 0 19 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M17.6906 15.1312L12.9094 11.25C14.9344 8.46562 14.625 4.58437 12.15 2.10938C10.8 0.73125 9 0 7.11562 0C5.23125 0 3.45938 0.73125 2.10938 2.08125C0.759375 3.43125 0 5.23125 0 7.11562C0 9 0.759375 10.8 2.10938 12.15C3.54375 13.5844 5.34375 14.2594 7.14375 14.2594C8.85938 14.2594 10.6031 13.6687 11.9531 12.375L16.8188 16.3406C16.9594 16.4812 17.1281 16.4812 17.2688 16.4812C17.4937 16.4812 17.7188 16.3969 17.8594 16.1719C18.0844 15.8906 18.0844 15.4406 17.6906 15.1312ZM7.11562 12.7406C5.625 12.7406 4.19063 12.15 3.15 11.0812C2.10938 10.0406 1.49063 8.60625 1.49063 7.11562C1.49063 5.625 2.08125 4.19063 3.15 3.15C4.21875 2.10938 5.625 1.49063 7.11562 1.49063C8.60625 1.49063 10.0406 2.08125 11.0813 3.15C12.1219 4.21875 12.7406 5.625 12.7406 7.11562C12.7406 8.60625 12.15 10.0406 11.0813 11.0812C10.0406 12.15 8.63437 12.7406 7.11562 12.7406Z"
                                fill="#186DDF"></path>
                        </svg>



                    </div>
                </div>
            </div>
            <a href="/Basket" className="cart">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M7.73254 15.5158H7.73364C7.73456 15.5158 7.73547 15.5156 7.73639 15.5156H20.4844C20.7982 15.5156 21.0742 15.3074 21.1604 15.0057L23.9729 5.16193C24.0335 4.94971 23.991 4.72156 23.8583 4.54541C23.7253 4.36926 23.5175 4.26562 23.2969 4.26562H6.11096L5.60834 2.00372C5.53674 1.68201 5.25146 1.45312 4.92188 1.45312H0.703125C0.314758 1.45312 0 1.76788 0 2.15625C0 2.54462 0.314758 2.85938 0.703125 2.85938H4.35791C4.4469 3.26019 6.76318 13.6837 6.89648 14.2833C6.14923 14.6082 5.625 15.3532 5.625 16.2188C5.625 17.3818 6.57129 18.3281 7.73438 18.3281H20.4844C20.8727 18.3281 21.1875 18.0134 21.1875 17.625C21.1875 17.2366 20.8727 16.9219 20.4844 16.9219H7.73438C7.34674 16.9219 7.03125 16.6064 7.03125 16.2188C7.03125 15.8317 7.34564 15.5167 7.73254 15.5158ZM22.3647 5.67188L19.9539 14.1094H8.29834L6.42334 5.67188H22.3647Z"
                        fill="white"></path>
                    <path
                        d="M7.03125 20.4375C7.03125 21.6006 7.97754 22.5469 9.14062 22.5469C10.3037 22.5469 11.25 21.6006 11.25 20.4375C11.25 19.2744 10.3037 18.3281 9.14062 18.3281C7.97754 18.3281 7.03125 19.2744 7.03125 20.4375ZM9.14062 19.7344C9.52826 19.7344 9.84375 20.0499 9.84375 20.4375C9.84375 20.8251 9.52826 21.1406 9.14062 21.1406C8.75299 21.1406 8.4375 20.8251 8.4375 20.4375C8.4375 20.0499 8.75299 19.7344 9.14062 19.7344Z"
                        fill="white"></path>
                    <path
                        d="M16.9688 20.4375C16.9688 21.6006 17.915 22.5469 19.0781 22.5469C20.2412 22.5469 21.1875 21.6006 21.1875 20.4375C21.1875 19.2744 20.2412 18.3281 19.0781 18.3281C17.915 18.3281 16.9688 19.2744 16.9688 20.4375ZM19.0781 19.7344C19.4658 19.7344 19.7812 20.0499 19.7812 20.4375C19.7812 20.8251 19.4658 21.1406 19.0781 21.1406C18.6905 21.1406 18.375 20.8251 18.375 20.4375C18.375 20.0499 18.6905 19.7344 19.0781 19.7344Z"
                        fill="white"></path>
                </svg>
                <span className="basket-text">Корзина</span>
                <div id="cart_line">
                    <div id="bx_basketFKauiI" className="bx-basket bx-opener">

                        <span className="basket-circle">{basket.totalCount}</span></div>
                </div>
            </a>
        </header>
    );
});

export default Header;