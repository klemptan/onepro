{"ast":null,"code":"import { makeAutoObservable, toJS } from \"mobx\";\nexport default class BasketStore {\n  constructor() {\n    let basketInLS = localStorage.getItem('basketGoods');\n    if (basketInLS) {\n      this._goods = JSON.parse(basketInLS);\n    } else {\n      this._goods = [];\n    }\n    this._totalSum = 0;\n    let favorites = localStorage.getItem('favorites');\n    if (favorites) {\n      this._favorites = JSON.parse(favorites);\n    } else {\n      this._favorites = [];\n    }\n    makeAutoObservable(this);\n  }\n  indexOf(goodId) {\n    for (var i = 0; i < this._goods.length; i++) {\n      if (this._goods[i].good.id == goodId) {\n        return i;\n      }\n    }\n    return -1;\n  }\n  setGood(good) {\n    let index = this.indexOf(good.id);\n    if (index != -1) {\n      this._goods[index].amount++;\n    } else {\n      this._goods.push({\n        good: good,\n        amount: 1\n      });\n    }\n    localStorage.setItem('basketGoods', JSON.stringify(this._goods));\n  }\n  unsetGood(goodId, unsetFull) {\n    let index = this.indexOf(goodId);\n    if (unsetFull) {\n      this._goods.splice(index, 1);\n    } else {\n      this._goods[index].amount--;\n      if (this._goods[index].amount === 0) {\n        this._goods.splice(index, 1);\n      }\n    }\n    localStorage.setItem('basketGoods', JSON.stringify(this._goods));\n  }\n  empty() {\n    this._goods = [];\n    localStorage.setItem('basketGoods', JSON.stringify(this._goods));\n  }\n  setFavoriteGood(good) {\n    this._favorites.push(good);\n    localStorage.setItem('favouroites', JSON.stringify(this._favorites));\n  }\n  unsetFavoriteGood(goodId) {\n    let index = -1;\n    for (var i = 0; i < this._favorites.length; i++) {\n      if (this._favorites[i].id == goodId) {\n        index = i;\n        break;\n      }\n    }\n    this._favorites.splice(index, 1);\n    localStorage.setItem('favouroites', JSON.stringify(this._favorites));\n  }\n  get favorites() {\n    return this._favorites;\n  }\n  get totalCount() {\n    let counter = 0;\n    for (var item of this._goods) {\n      counter += item.amount;\n    }\n    return counter;\n  }\n  get goods() {\n    return this._goods;\n  }\n  get totalSum() {\n    let total = 0;\n    this._goods.map(m => {\n      total += m.good.price * m.amount;\n    });\n    return total;\n  }\n  get isEmpty() {\n    return this.totalCount == 0;\n  }\n}","map":{"version":3,"names":["makeAutoObservable","toJS","BasketStore","constructor","basketInLS","localStorage","getItem","_goods","JSON","parse","_totalSum","favorites","_favorites","indexOf","goodId","i","length","good","id","setGood","index","amount","push","setItem","stringify","unsetGood","unsetFull","splice","empty","setFavoriteGood","unsetFavoriteGood","totalCount","counter","item","goods","totalSum","total","map","m","price","isEmpty"],"sources":["D:/заказы/onepro/client/src/store/BasketStore.js"],"sourcesContent":["import { makeAutoObservable, toJS } from \"mobx\"\r\n\r\nexport default class BasketStore {\r\n    constructor() {\r\n        let basketInLS = localStorage.getItem('basketGoods')\r\n        if (basketInLS) {\r\n            this._goods = JSON.parse(basketInLS)\r\n        }\r\n        else {\r\n            this._goods = []\r\n        }\r\n        this._totalSum = 0\r\n\r\n        let favorites = localStorage.getItem('favorites')\r\n        if(favorites) {\r\n            this._favorites = JSON.parse(favorites)\r\n        }\r\n        else {\r\n            this._favorites = []\r\n        }\r\n\r\n        makeAutoObservable(this)\r\n    }\r\n\r\n    indexOf(goodId) {\r\n        for(var i=0;i<this._goods.length;i++){\r\n            if(this._goods[i].good.id==goodId) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n    setGood(good) {\r\n        let index = this.indexOf(good.id)\r\n        if (index != -1) {\r\n            this._goods[index].amount++\r\n        }\r\n        else {\r\n            this._goods.push({\r\n                good: good,\r\n                amount: 1\r\n            })\r\n        }\r\n        localStorage.setItem('basketGoods', JSON.stringify(this._goods))\r\n    }\r\n\r\n    unsetGood(goodId, unsetFull) {\r\n        let index = this.indexOf(goodId)\r\n        if (unsetFull) {\r\n            this._goods.splice(index, 1)\r\n        }\r\n        else {\r\n            this._goods[index].amount--\r\n            if(this._goods[index].amount===0) {\r\n                this._goods.splice(index, 1)\r\n            }\r\n        }\r\n        localStorage.setItem('basketGoods', JSON.stringify(this._goods))\r\n    }\r\n\r\n    empty() {\r\n        this._goods = []\r\n        localStorage.setItem('basketGoods', JSON.stringify(this._goods))\r\n    }\r\n\r\n    setFavoriteGood(good) {\r\n        this._favorites.push(good)\r\n        localStorage.setItem('favouroites', JSON.stringify(this._favorites))\r\n    }\r\n    unsetFavoriteGood(goodId){\r\n        let index=-1;\r\n        for(var i=0;i<this._favorites.length;i++){\r\n            if(this._favorites[i].id==goodId) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n        this._favorites.splice(index, 1)\r\n        localStorage.setItem('favouroites', JSON.stringify(this._favorites))\r\n    }\r\n\r\n    get favorites(){\r\n        return this._favorites\r\n    }\r\n\r\n    get totalCount() {\r\n        let counter=0\r\n        for(var item of this._goods){\r\n            counter+=item.amount\r\n        }\r\n        return counter;\r\n    }\r\n\r\n    get goods() {\r\n        return this._goods\r\n    }\r\n\r\n    get totalSum() {\r\n        let total = 0\r\n        this._goods.map((m) => {\r\n            total += m.good.price * m.amount\r\n        })\r\n        return total\r\n    }\r\n\r\n    get isEmpty(){\r\n        return this.totalCount==0\r\n    }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}